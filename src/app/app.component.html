<mat-progress-bar mode="indeterminate" *ngIf="isLoading$ | async"></mat-progress-bar>
<div class="flex flex-col h-screen">
  <!-- header -->
  <header class="text-slate-500 fixed z-10 w-full"
          [ngClass]="{'backdrop-blur-md transition-all duration-300 ease-in-out': isScrolled}">

    <!-- Riga sopra alta 8 -->
    <div class="h-8 w-full transition-all duration-500 ease-in-out"
         [ngClass]="{'pl-64': !isSidebarMinimized, 'pl-16': isSidebarMinimized}">
      <app-breadcrumb></app-breadcrumb>
    </div>

    <div class="mx-auto flex items-center h-16">

      <!-- logo -->
      <div class="flex-shrink-0 flex items-center justify-start transition-all duration-500 ease-in-out"
           [ngClass]="{'w-64': !isSidebarMinimized, 'w-16': isSidebarMinimized}">
        <div class="transition-all duration-500 ease-in-out flex items-center"
             [ngClass]="{'pl-7 scale-100': !isSidebarMinimized, 'pl-3 scale-75': isSidebarMinimized}">
          <img src="/images/logo.svg" class="w-10 h-auto max-h-10" alt="Hive App Logo"/>
          <span class="comfortaa-text font-bold gradient-text text-2xl transition-all duration-500 ml-3"
                [ngClass]="{
                          'opacity-100 pointer-events-auto': !isSidebarMinimized,
                          'opacity-0 pointer-events-none': isSidebarMinimized
                      }">hive</span>
        </div>
      </div>
      <div class="flex items-center justify-between w-full px-4 transition-all duration-500 ease-in-out">
        <div class="flex items-center justify-start">
          <button (click)="toggleSidebar()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                 class="w-6 h-6 text-slate-400">
              <path #iconPath stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
          <span class="comfortaa-text font-bold gradient-text text-2xl transition-all duration-500 ml-3">hive</span>
        </div>
        <div class="ml-auto">
          <div class="flex items-center">
            <ul class="flex flex-wrap justify-center list-none lg:justify-end">
              <li class="nav-item flex items-center">
                <button class="block font-normal ease-soft-in-out text-sm text-slate-500 hover:text-slate-800 mr-2
                            rounded-2xl p-2 text-center transition-all"
                        (click)="_toggleNotificationPanel()" type="button">
                  <img
                    alt="user 1"
                    src="https://images.unsplash.com/photo-1633332755192-727a05c4013d?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1480&amp;q=80"
                    class="relative inline-block h-8 w-8 rounded-full border-2 border-white object-cover object-center hover:ring-2 hover:ring-fuchsia-400 transition-all duration-300"
                  />
                </button>
              </li>
              <li class="nav-item flex items-center">
                <button class="font-normal text-sm text-slate-500
                            rounded-2xl p-2 text-center transition-all
                            flex items-center justify-center
                            hover:text-slate-800 hover:bg-slate-200
                            focus:bg-slate-100 active:bg-slate-100
                            ease-soft-in-out"
                        (click)="_toggleNotificationPanel()" type="button">
                  <fa-icon [icon]="faUser" class="mr-2"></fa-icon>
                  Log Out
                </button>
              </li>
              <li class="nav-item flex items-center">
                <button class="font-normal text-sm text-slate-500
                            rounded-2xl p-2 text-center transition-all
                            w-10 h-10 flex items-center justify-center
                            hover:text-slate-800 hover:bg-slate-200
                            focus:bg-slate-100 active:bg-slate-100
                            ease-soft-in-out"
                        (click)="_toggleNotificationPanel()" type="button">
                  <fa-icon [icon]="faGear"></fa-icon>
                </button>
              </li>
              <li class="nav-item flex items-center">
                <button class="font-normal text-sm text-slate-500
                            rounded-2xl p-2 text-center transition-all
                            w-10 h-10 flex items-center justify-center
                            hover:text-slate-800 hover:bg-slate-200
                            focus:bg-slate-100 active:bg-slate-100
                            ease-soft-in-out"
                        (click)="_toggleNotificationPanel()" type="button">
                  <fa-icon [icon]="faBell"></fa-icon>
                  <span
                    class="absolute top-14 right-6 w-1.5 h-1.5 bg-red-500 rounded-full"></span>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </header>

  <!-- main -->
  <div class="flex flex-1 pt-24">
    <!-- sidebar -->
    <aside [ngClass]="{'w-64': !isSidebarMinimized, 'w-16': isSidebarMinimized}"
           class="text-slate-500 h-full fixed z-10 transition-all duration-500 ease-in-out overflow-hidden">
      <div class="h-full overflow-y-auto">
        <ul>
          @for (item of menuItems; track item) {
            <li class="mt-5 w-full">
              <a #menuLink class="text-sm my-0 mx-4 flex items-center whitespace-nowrap px-4"
                 [routerLink]="item.link">
                <div class="icon-container shadow-md shadow-slate-400 w-8 min-w-8 h-8 mr-2 bg-white
                text-slate-500 rounded-md flex items-center justify-center
                hover:scale-110 hover:shadow-lg hover:duration-300" style="z-index: 9;">
                  <fa-icon [icon]="item.icon"></fa-icon>
                </div>
                <span #menuText class="ml-1 menu-text" style="z-index: 1;">{{ item.label }}</span>
              </a>
            </li>
          }
        </ul>
      </div>
    </aside>

    <!-- main -->
    <div [ngClass]="{'ml-64': !isSidebarMinimized, 'ml-16': isSidebarMinimized}"
         class="flex-1 overflow-y-auto p-4 transition-all duration-500 ease-in-out"
         [ngStyle]="{'margin-right': isNotificationPanelOpen ? '256px' : '0', 'min-height': 'calc(100vh - 11rem)'}">
      <main>
        <router-outlet/>
      </main>
    </div>

    <!-- notification -->
    <aside class="bg-white text-slate-500 h-full fixed right-0 w-64 z-10
           transition-transform duration-300 ease-in-out rounded-l-lg my-4"
           [ngClass]="{'transform translate-x-0': isNotificationPanelOpen, 'transform translate-x-full': !isNotificationPanelOpen}">
      <div class="h-full overflow-y-auto">
        <app-notification-center></app-notification-center>
      </div>
    </aside>
  </div>

  <!-- Footer -->
  <div [ngClass]="{'ml-64': !isSidebarMinimized, 'ml-16': isSidebarMinimized}"
       class="mt-auto flex-1 py-4 transition-all duration-500 ease-in-out"
       [ngStyle]="{'margin-right': isNotificationPanelOpen ? '256px' : '0'}">
    <app-footer></app-footer>
  </div>
</div>
