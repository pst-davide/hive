<mat-progress-bar mode="indeterminate" *ngIf="isLoading$ | async"></mat-progress-bar>
<div class="flex flex-col h-screen">
  <!-- header -->
  <app-header [(isScrolled)]="isScrolled"
              [(isSidebarMinimized)]="isSidebarMinimized"
              [(isNotificationPanelOpen)]="isNotificationPanelOpen"></app-header>

  <!-- main -->
  <div class="flex flex-1 pt-24">
    <!-- sidebar -->
    <aside [ngClass]="{'w-60': !isSidebarMinimized(), 'w-16': isSidebarMinimized()}"
           class="text-slate-500 h-full fixed z-10 transition-all duration-500 ease-in-out overflow-hidden">
      <div class="h-full overflow-y-auto">
        <ul>
          <li *ngFor="let item of menuItems" class="mt-5 w-full">
            <a #menuLink class="text-sm my-0 mx-3 flex items-center whitespace-nowrap px-4"
               [routerLink]="item.link" (click)="item.subItems ? toggleSubmenu(item) : null">
              <div class="icon-container shadow-md shadow-slate-400 w-8 min-w-8 h-8 mr-2 bg-white
          text-slate-500 rounded-md flex items-center justify-center
          hover:scale-110 hover:shadow-lg hover:duration-300">
                <fa-icon [icon]="item.icon"></fa-icon>
              </div>

              <!-- Testo principale -->
              <span #menuText class="ml-1 text-xs"
                    style="z-index: 1;">{{ item.label }}</span>

              <!-- Chevron -->
              <fa-icon *ngIf="item.subItems" [icon]="faChevronDown" class="chevron ml-auto"
                       [ngClass]="{'rotate-180': item.isOpen, 'rotate-0': !item.isOpen}"
                       style="transition: transform 0.15s ease-in-out;"></fa-icon>
            </a>

            <!-- Submenu -->
            <ul *ngIf="item.isOpen" class="pl-12">
              <li *ngFor="let subItem of item.subItems" class="my-2">
                <a class="text-xs flex items-center whitespace-nowrap" [routerLink]="subItem.link">
                  <fa-icon [icon]="subItem.icon" class="mr-2 text-xs"></fa-icon>
                  <span *ngIf="!isSidebarMinimized()">{{ subItem.label }}</span>
                </a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </aside>

    <!-- main -->
    <div [ngClass]="{'ml-60': !isSidebarMinimized(), 'ml-16': isSidebarMinimized()}"
         class="flex-1 overflow-y-auto p-4 transition-all duration-500 ease-in-out"
         [ngStyle]="{'margin-right': isNotificationPanelOpen() ? '256px' : '0', 'min-height': 'calc(100vh - 11rem)'}">
      <main>
        <router-outlet/>
      </main>
    </div>

    <!-- notification -->
    <aside class="bg-white text-slate-500 h-full fixed right-0 w-64 z-10
           transition-transform duration-300 ease-in-out rounded-l-lg my-4"
           [ngClass]="{'transform translate-x-0': isNotificationPanelOpen(), 'transform translate-x-full': !isNotificationPanelOpen()}">
      <div class="h-full overflow-y-auto">
        <app-notification-center></app-notification-center>
      </div>
    </aside>
  </div>

  <!-- Footer -->
  <div [ngClass]="{'ml-60': !isSidebarMinimized(), 'ml-16': isSidebarMinimized()}"
       class="mt-auto flex-1 py-4 transition-all duration-500 ease-in-out"
       [ngStyle]="{'margin-right': isNotificationPanelOpen() ? '256px' : '0'}">
    <app-footer></app-footer>
  </div>
</div>
